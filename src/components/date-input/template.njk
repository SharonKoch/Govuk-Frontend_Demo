{% from "../form-group/macro.njk" import govukFormGroup %}
{% from "../label/macro.njk" import govukLabel %}

{% if params.items %}
  {% set dateInputItems = params.items %}
{% else %}
  {% set dateInputItems = [
    {
      name: "day",
      classes: "govuk-input--width-2"
    },
    {
      name: "month",
      classes: "govuk-input--width-2"
    },
    {
      name: "year",
      classes: "govuk-input--width-4"
    }
  ] %}
{% endif %}

{#- We override the fieldset's role to 'group' because otherwise JAWS does not
    announce the description for a fieldset comprised of text inputs, but
    adding the role to the fieldset always makes the output overly verbose for
    radio buttons or checkboxes. -#}
{% call govukFormGroup({
  id: params.id,
  fieldset: {
    attributes: {
      role: "group"
    },
    legend: params.fieldset.legend
  },
  hint: params.hint,
  errorMessage: params.errorMessage,
  formGroup: params.formGroup
}) %}
  <div class="govuk-date-input {%- if params.classes %} {{ params.classes }}{% endif %}"
    {%- for attribute, value in params.attributes %} {{attribute}}="{{value}}"{% endfor %}
    {%- if params.id %} id="{{ params.id }}"{% endif %}>
    {% for item in dateInputItems %}
    <div class="govuk-date-input__item">
      {{ govukLabel({
        text: item.label if item.label else item.name | capitalize,
        classes: "govuk-date-input__label",
        for: item.id if item.id else (params.id + "-" + item.name)
      }) | indent(4) | trim }}
      <input class="govuk-input govuk-date-input__input {%- if item.classes %} {{ item.classes }}{% endif %}" id="{{ item.id if item.id else (params.id + '-' + item.name) }}" name="{{ (params.namePrefix + '-' + item.name) if params.namePrefix else item.name }}" type="number" pattern="{{ item.pattern if item.pattern else '[0-9]*' }}"
      {%- if item.value %} value="{{ item.value }}"{% endif %}
      {%- if item.autocomplete %} autocomplete="{{ item.autocomplete}}"{% endif %}
      {%- for attribute, value in item.attributes %} {{ attribute }}="{{ value }}"{% endfor -%}>
    </div>
  {% endfor %}
  </div>
{% endcall %}
